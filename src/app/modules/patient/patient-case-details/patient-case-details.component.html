<div class="container-fluid">
    <div class="row">
       <div class="col-sm-12 col-lg-12">
          <div class="iq-card">
             <div class="iq-card-header d-flex justify-content-between">
                <div class="iq-header-title">
                   <h4 class="card-title">Case Details</h4>
                </div>
             </div>
             <div class="iq-card-body">
                <div class="stepwizard mt-4">
                   <div class="stepwizard-row setup-panel">
                      <div class="wizard-step ml-3" [ngClass]="{ 'step-valid' : step > 1, 'active' : step==1 }" >
                         <a href="javascript:void(0);" (click)="changeStep(1)" class="btn">
                         <i class="ri-lock-unlock-line"></i><span>Case Details</span>
                         </a>
                      </div>
                      <div class="wizard-step" [ngClass]="{ 'step-valid' : step > 2, 'active' : step==2 }" >
                         <a href="javascript:void(0);" (click)="changeStep(2)" class="btn btn-default">
                         <i class="ri-user-fill"></i><span>Questionnaire</span>
                         </a>
                      </div>
                      <div class="wizard-step" [ngClass]="{ 'step-valid' : step > 3, 'active' : step==3 }" >
                         <a href="javascript:void(0);" (click)="changeStep(3)" class="btn btn-default">
                         <i class="ri-camera-fill"></i><span>History</span>
                         </a>
                      </div>
                      <div class="wizard-step" [ngClass]="{ 'step-valid' : step > 4, 'active' : step==4 }" >
                         <a href="javascript:void(0);" (click)="changeStep(4)" class="btn btn-default">
                         <i class="ri-check-fill"></i><span>Reports</span>
                         </a>
                      </div>
                      <div class="wizard-step" [ngClass]="{ 'active' : step==5 }" >
                        <a href="javascript:void(0);" (click)="changeStep(5)" class="btn btn-default">
                        <i class="ri-camera-fill"></i><span>Summary</span>
                        </a>
                     </div>
                   </div>
                </div>
              
               
            <!-- Step 1: Service Details Tab : (s) -->
            <form class="form" [formGroup]="step1Form" (ngSubmit)="onSubmit()" novalidate>
                <div class="row setup-content" id="service-details" [style.display]="step == 1 ? 'flex' : 'none'">
                   <div class="col-sm-12">
                      <div class="col-md-12 p-0">
                         <h3 class="mb-4">Service Details:</h3>
                         
                         <div class="row">
                           <div class="col-md-3 text-center">
                             <img src="../../../assets/images/user/1.jpg"  style="border-radius: 50%;" class="userProfile" />
                           </div>
                           <div class="col-md-8">
                             <div class="row">
                               <div class="form-group col-md-6 ">
                                 <div class="custom-control custom-radio custom-control-inline" >
                                   <input type="radio" id="inpatient" formControlName="caseType" value="inpatient" class="custom-control-input">
                                   <label class="custom-control-label" for="inpatient"> In-Patient </label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline"
                                [ngClass]="{ 'is-invalid': isSubmittedStep1 && step1FormData.caseType.errors }">
                                   <input type="radio" id="outpatient" formControlName="caseType" value="outpatient" class="custom-control-input">
                                   <label class="custom-control-label" for="outpatient"> Out-Patient </label>
                                </div>

                                <div class="invalid-feedback" >
                                 {{ getErrorMessage('case-type') }}
                                </div>
                               </div>
                             </div>
                             <div class="row">
                               <div class="form-group col-md-6">
                                 <label>Service Category <span class="text-danger">*</span></label>
                                 <select class="form-control form-control-lg" 
                                   [ngClass]="{ 'is-invalid': isSubmittedStep1 && step1FormData.serviceCategory.errors }" 
                                   formControlName="serviceCategory" (change)="getSubCategory(step1FormData.serviceCategory.value)">
                                    <option value="" disabled>Select Category</option>
                                    <option *ngFor="let category of categories" [value]="category.id">{{category.name}}</option>
                                 </select>
                                 <div class="invalid-feedback" *ngIf="step1FormData.serviceCategory.errors">
                                   {{ getErrorMessage('service-category') }}
                                 </div>
                               </div>
                               <div class="form-group col-md-6">
                                 <label>Sub Category <span class="text-danger">*</span></label>
                                 <select class="form-control form-control-lg" 
                                   [ngClass]="{ 'is-invalid': isSubmittedStep1 && step1FormData.serviceSubCategory.errors }" 
                                   formControlName="serviceSubCategory">
                                   <option value="" disabled>Select Sub-Category</option>
                                   <option *ngFor="let subCategory of subCategories" [value]="subCategory.id">{{subCategory.name}}</option>
                                 </select>
                                 <div class="invalid-feedback" *ngIf="step1FormData.serviceSubCategory.errors">
                                   {{ getErrorMessage('service-sub-category') }}
                                 </div>
                               </div>
                             </div>
                           </div>
                           
                         </div>

                         <div class="row">
                           <div class="form-group col-md-6">
                             <label class="control-label">First Name</label>
                             <input type="text" readonly class="form-control" formControlName="firstName" />
                           </div>
                           <div class="form-group col-md-6">
                             <label class="control-label">Last Name</label>
                             <input type="text" readonly class="form-control" formControlName="lastName" />
                           </div>

                         </div>
                         <div class="row">
                           <div class="form-group col-md-6">
                             <label class="control-label">Email</label>
                             <input type="email" readonly class="form-control" formControlName="email" />
                           </div>
                           <div class="form-group col-md-6">
                             <label class="control-label">Contact No</label>
                             <input type="text" readonly class="form-control" formControlName="contactNumber" />
                           </div>
                         </div>

                         <div class="row" formGroupName="address">
                           <div class="form-group col-md-6">
                             <label class="control-label">Address Line 1</label>
                             <textarea readonly class="form-control" rows="3" formControlName="street1"></textarea>
                           </div>
                           <div class="form-group col-md-6">
                             <label class="control-label">Address Line 2</label>
                             <textarea readonly class="form-control" rows="3" formControlName="street2"></textarea>
                           </div>
                           <div class="form-group col-md-6">
                             <label class="control-label">City</label>
                             <input type="text" readonly class="form-control" formControlName="city" />
                           </div>
                           <div class="form-group col-md-6">
                             <label class="control-label">State</label>
                             <input type="text" readonly class="form-control" formControlName="state" />
                           </div>
                           <div class="form-group col-md-6">
                             <label class="control-label">Postal Code</label>
                             <input type="text" readonly class="form-control" formControlName="postalCode" />
                           </div>
                           <div class="form-group col-md-6">
                             <label class="control-label">Country</label>
                             <input type="text" readonly class="form-control" formControlName="country" />
                           </div>
                         </div>
                         
                         <div class="row">
                           <div class="form-group col-md-6">
                             <label class="control-label">Age</label>
                             <input type="text" readonly class="form-control" formControlName="age" />
                           </div>
                           <div class="form-group col-md-6">
                               <label class="control-label">Gender</label>
                               <input type="text" readonly class="form-control" formControlName="gender" />
                           </div>
                         </div>
                         <div class="row">
                           <div class="form-group col-md-6">
                             <label class="control-label">Weight <span class="text-danger">*</span></label>
                             <input type="text" class="form-control" formControlName="weight" 
                             [class.is-invalid]="isSubmittedStep1 && step1FormData.weight.errors"
                             />
                             <div class="invalid-feedback">
                               {{ getErrorMessage('weight') }}
                             </div>
                           </div>
                           <div class="form-group col-md-6">
                               <label class="control-label">Height <span class="text-danger">*</span></label>
                               <input type="text" class="form-control" formControlName="height" 
                               [class.is-invalid]="isSubmittedStep1 && step1FormData.height.errors"
                               />
                               <div class="invalid-feedback">
                                 {{ getErrorMessage('height') }}
                               </div>
                           </div>
                         </div>

                         <div class="row">
                           <div class="form-group col-md-6">
                             <label class="control-label">Nationality</label>
                             <input type="text" readonly class="form-control" formControlName="nationality" />
                           </div>
                           <div class="form-group col-md-6">
                               <label class="control-label">Occupation</label>
                               <input type="text" readonly class="form-control" formControlName="occupation" />
                           </div>
                         </div>


                         <h3 class="mb-4">Patient History:</h3>
                          <div class="row">
                            <div class="form-group col-md-6">
                                <label>Marital Status <span class="text-danger">*</span></label>
                                <select class="form-control form-control-lg" 
                                  formControlName="maritalStatus"
                                  [class.is-invalid]="isSubmittedStep2 && step1FormData.maritalStatus.errors">
                                   <option value="Single">Single</option>
                                   <option value="Married">Married</option>
                                   <option value="Divorced">Divorced</option>
                                   <option value="Widowed">Widowed</option>
                                </select>
                                <div class="invalid-feedback" *ngIf="step1FormData.maritalStatus.errors">
                                  {{ getErrorMessage('maritalStatus') }}
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                              <label>Children</label>
                              <input type="text" class="form-control" 
                              formControlName="childrens" value="0" 
                              [class.is-invalid]="isSubmittedStep2 && step1FormData.childrens.errors"/>
                              <div class="invalid-feedback" *ngIf="step1FormData.childrens.errors">
                                {{ getErrorMessage('childrens') }}
                              </div>
                            </div>
                          </div>

                          <div class="row">
                            <div class="form-group col-md-6 mb-0" >
                              <label class="mt-3 mr-3">Do you smoke ?</label>
                              <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" id="smoking_yes" value="Yes" class="custom-control-input" formControlName="smoking">
                                <label class="custom-control-label" for="smoking_yes"> Yes </label>
                              </div>
                              <div class="custom-control custom-radio custom-control-inline">
                                  <input type="radio" id="smoking_no" value="No" class="custom-control-input" formControlName="smoking">
                                  <label class="custom-control-label" for="smoking_no"> No </label>
                              </div>
                            </div>
                          </div>
                          <div class="row"  [class.d-none]="step1FormData.smoking.value == 'No'">
                            <div class="form-group col-md-6">
                              <label>Type</label>
                              <input type="text" class="form-control" placeholder="ex. Chain Smoker"
                              formControlName="smokingType" [class.is-invalid]="isSubmittedStep2 && step1FormData.smokingType.errors" />
                              <div class="invalid-feedback" *ngIf="step1FormData.smokingType.errors">
                                {{ getErrorMessage('smokingType') }}
                              </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Frequency</label>
                                <select class="form-control form-control-lg" 
                                [class.is-invalid]="isSubmittedStep2 && step1FormData.smokingFrequency.errors"
                                formControlName="smokingFrequency">
                                   <option value="Daily">Daily</option>
                                   <option value="Alternate Days">Alternate Days</option>
                                   <option value="Once in a week">Once in a week</option>
                                   <option value="Rarely">Rarely</option>
                                </select>
                                <div class="invalid-feedback" *ngIf="step1FormData.smokingFrequency.errors">
                                  {{ getErrorMessage('smokingFrequency') }}
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                              <label>Time period</label>
                              <input type="text" class="form-control"
                              [class.is-invalid]="isSubmittedStep2 && step1FormData.smokingTimePeriod.errors" 
                                formControlName="smokingTimePeriod" placeholder="ex. Since 2012" />
                                <div class="invalid-feedback" *ngIf="step1FormData.smokingTimePeriod.errors">
                                  {{ getErrorMessage('smokingTimePeriod') }}
                                </div>
                            </div>
                          </div>


                          <div class="row">
                            <div class="form-group col-md-12 mb-0">
                              <label class="mt-3 mr-4">Do you drink ?</label>
                               
                              <div class="custom-control custom-radio custom-control-inline" [class.is-invalid]="isSubmittedStep2 && step1FormData.drinking.errors">
                                <input type="radio" id="drink_yes" value="Yes" formControlName="drinking" class="custom-control-input">
                                <label class="custom-control-label" for="drink_yes"> Yes </label>
                              </div>
                              <div class="custom-control custom-radio custom-control-inline">
                                  <input type="radio" id="drink_no" value="No" formControlName="drinking" class="custom-control-input">
                                  <label class="custom-control-label" for="drink_no"> No </label>
                              </div>
                              <div class="invalid-feedback" *ngIf="step1FormData.drinking.errors">
                                {{ getErrorMessage('requiredRadio') }}
                              </div>
                            </div>
                          </div>
                          

                          <div class="row" [class.d-none]="step1FormData.drinking.value == 'No'">
                            <div class="form-group col-md-6">
                              <label>Type</label>
                              <input type="text" class="form-control" 
                              [class.is-invalid]="isSubmittedStep2 && step1FormData.drinkingType.errors"
                              formControlName="drinkingType" placeholder="ex. Occasionaly" />
                              <div class="invalid-feedback" *ngIf="step1FormData.drinkingType.errors">
                                {{ getErrorMessage('drinkingType') }}
                              </div>
                            </div>
                            <div class="form-group col-md-6">
                                <label>Frequency</label>
                                <select class="form-control form-control-lg" 
                                [class.is-invalid]="isSubmittedStep2 && step1FormData.drinkingFrequency.errors"
                                formControlName="drinkingFrequency">
                                  <option value="Daily">Daily</option>
                                  <option value="Alternate Days">Alternate Days</option>
                                  <option value="Once in a week">Once in a week</option>
                                  <option value="Rarely">Rarely</option>
                                </select>
                                <div class="invalid-feedback" *ngIf="step1FormData.drinkingFrequency.errors">
                                  {{ getErrorMessage('drinkingFrequency') }}
                                </div>
                            </div>
                            <div class="form-group col-md-6">
                              <label>Time period</label>
                              <input type="text" [class.is-invalid]="isSubmittedStep2 && step1FormData.drinkingTimePeriod.errors"
                               formControlName="drinkingTimePeriod" class="form-control" placeholder="ex. Since 2012" />
                              <div class="invalid-feedback" *ngIf="step1FormData.drinkingTimePeriod.errors">
                                {{ getErrorMessage('drinkingTimePeriod') }}
                              </div>
                            </div>
                          </div>

                          <div class="row">
                            <div class="form-group col-md-6">
                              <label class="mt-3 mr-3">Diet: </label>
                               
                              <div class="custom-control custom-radio custom-control-inline" [class.is-invalid]="isSubmittedStep2 && step1FormData.diet.errors">
                                <input type="radio" id="diet_veg" formControlName="diet" value="Veg" class="custom-control-input">
                                <label class="custom-control-label" for="diet_veg"> Veg</label>
                              </div>
                              <div class="custom-control custom-radio custom-control-inline">
                                  <input type="radio" id="diet_nonveg" formControlName="diet" value="Non Veg" class="custom-control-input">
                                  <label class="custom-control-label" for="diet_nonveg"> Non Veg</label>
                              </div>
                              <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" id="diet_mixed" formControlName="diet" value="Mixed" class="custom-control-input">
                                <label class="custom-control-label" for="diet_mixed"> Mixed</label>
                              </div>
                              <div class="invalid-feedback" *ngIf="step1FormData.diet.errors">
                                {{ getErrorMessage('requiredRadio') }}
                              </div>
                            </div>
                            
                          </div>



                          <div class="row">
                            <div class="form-group col-md-6">
                              <label class="control-label">Travel History</label>
                              <textarea class="form-control" 
                              [class.is-invalid]="isSubmittedStep2 && step1FormData.travelHistory.errors"
                              formControlName="travelHistory" rows="3"></textarea>

                              <div class="invalid-feedback" *ngIf="step1FormData.travelHistory.errors">
                                {{ getErrorMessage('travelHistory') }}
                              </div>
                            </div>

                            <div class="form-group col-md-6">
                              <label >Drug (Abuse/Prescribed)</label>
                              <div class="input-group">
                                <input [class.d-none]="disableForm" type="file" id="drug" (change)="onFileChange($event, 'prescribedDrugFile')" >
                                <div class="input-group-append" *ngIf="file_prescribedDrugFile">
                                  <button type="button" class="btn btn-primary" (click)="uploadFile('prescribedDrugFile')">Upload</button>
                                </div>
                              </div>
                              <p class="mt-3" *ngFor="let filename of uploadedFiles_prescribedDrugFile">
                                <a (click)="getSignedUrl('prescribedDrugFile', getOnlyFileName(filename))"  href="javascript:void(0);" class="mr-3" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                                <button type="button" 
                                *ngIf="!disableForm"
                                (click)="confirmDeleteFile('prescribedDrugFile', filename)"
                                class="btn btn-sm btn-primary custom-btn-icon mr-3" ><i class="ri-delete-bin-2-fill pr-0"></i></button>
                              </p>
                            </div>
 
                          </div>


                          <h3 class="mb-4">Family Medical History:</h3>

                          <div class="row">
                            <div class="form-group col-md-6">
                              <label>Maternal History</label>
                              <input type="text" [class.is-invalid]="isSubmittedStep2 && step1FormData.maternal.errors" formControlName="maternal" placeholder="History of High BP, Diabetes, etc" class="form-control" />
                              <div class="invalid-feedback" *ngIf="step1FormData.maternal.errors">
                                {{ getErrorMessage('maternal') }}
                              </div>
                            </div>
                            <div class="form-group col-md-6">
                              <label>Paternal History</label>
                              <input type="text" [class.is-invalid]="isSubmittedStep2 && step1FormData.paternal.errors" formControlName="paternal" placeholder="History of High BP, Diabetes, etc" class="form-control" />
                              <div class="invalid-feedback" *ngIf="step1FormData.paternal.errors">
                                {{ getErrorMessage('paternal') }}
                              </div>
                            </div>
                          </div>

                          <div class="row">
                            <div class="form-group col-md-6">
                              <label>Sibling History</label>
                              <input type="text" [class.is-invalid]="isSubmittedStep2 && step1FormData.sibling.errors" formControlName="sibling" placeholder="History of High BP, Diabetes, etc" class="form-control" />
                              <div class="invalid-feedback" *ngIf="step1FormData.sibling.errors">
                                {{ getErrorMessage('sibling') }}
                              </div>
                            </div>
                            <div class="form-group col-md-6">
                              <label>Do you have any allergy?</label>
                              <input type="text" [class.is-invalid]="isSubmittedStep2 && step1FormData.allergies.errors" formControlName="allergies" class="form-control" />
                              <div class="invalid-feedback" *ngIf="step1FormData.allergies.errors">
                                {{ getErrorMessage('allergies') }}
                              </div>
                            </div>
                          </div>



                          <div class="row">
                            <div class="form-group col-md-6">
                              <label>Relevant Document</label>
                              <div class="input-group">
                                <input  [class.d-none]="disableForm" type="file" id="allergyDocFile" (change)="onFileChange($event, 'allergyDocFile')" >
                                <div class="input-group-append" *ngIf="file_allergyDocFile">
                                  <button type="button" class="btn btn-primary" (click)="uploadFile('allergyDocFile')">Upload</button>
                                </div>
                              </div>
                              <p class="mt-3" *ngFor="let filename of uploadedFiles_allergyDocFile">
                                <a (click)="getSignedUrl('allergyDocFile', getOnlyFileName(filename))"  href="javascript:void(0);" class="mr-3" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                                <button type="button" 
                                  *ngIf="!disableForm"
                                  (click)="confirmDeleteFile('allergyDocFile', filename)"
                                  class="btn btn-sm btn-primary custom-btn-icon mr-3" ><i class="ri-delete-bin-2-fill pr-0"></i></button>
                              </p>
                            </div>
                          </div>
                         
                         <button type="button" [class.d-none]="!disableForm" class="btn btn-primary next action-button float-right" (click)="changeStep(2)" >Next</button>
                         <button type="button" [class.d-none]="!disableForm || !caseEditable" (click)="editForm(true)" class="btn btn-light float-right mr-3" >Edit Form</button>
                         <button type="button" [class.d-none]="!disableForm" class="btn btn-light float-right mr-3" routerLink="/caremanager/cases" >Exit</button>

                         <button type="button" [class.d-none]="disableForm" (click)="saveForm()" class="btn btn-primary float-right mr-3" >Save</button>
                         <button type="button" [class.d-none]="disableForm" (click)="editForm(false)" class="btn btn-light float-right mr-3" >Cancel</button>

                        </div>
                   </div>
                </div>
            </form>
                

            <form [formGroup]="step2Form" (ngSubmit)="onSubmit()" novalidate>  
              <div class="row setup-content" id="questionair" [style.display]="step == 2 ? 'flex' : 'none'">
                 <div class="col-sm-12">
                    <div class="col-md-12 p-0">
                       <h3 class="mb-4">Questionnaire:</h3>
                       
                       <div class="alert bg-light" role="alert">
                         <div class="iq-alert-text"><b>Note: </b> If you are unsure as to what option to choose below or feel that your answer may be vague, please be rest assured that our care manager and doctor will reach out to you for a thorough diagnosis anyway so that the best medical treatment can be provided to you.</div>
                       </div>


                       <div class="row">
                         <div class="form-group col-md-6">
                           <label class="control-label">Past history of major illness</label>
                           <textarea class="form-control" rows="2" formControlName="pastMajorIllness" ></textarea>
                         </div>
                         
                         <div class="form-group col-md-6">
                           <label>Relevant Document</label>
                           <div class="input-group">
                             <input [class.d-none]="disableForm" type="file" id="illnessDocFile" (change)="onFileChange($event, 'pastHistoryofMajorillness')" >
                             <div class="input-group-append" *ngIf="file_pastHistoryofMajorillness">
                               <button type="button" class="btn btn-primary" (click)="uploadFile('pastHistoryofMajorillness')">Upload</button>
                             </div>
                           </div>
                           <p class="mt-3" *ngFor="let filename of uploadedFiles_pastHistoryofMajorillness">
                            <a (click)="getSignedUrl('pastHistoryofMajorillness', getOnlyFileName(filename))"  href="javascript:void(0);" class="mr-3" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                            <button type="button" 
                            *ngIf="!disableForm"
                            (click)="confirmDeleteFile('pastHistoryofMajorillness', filename)"
                            class="btn btn-sm btn-primary custom-btn-icon mr-3" ><i class="ri-delete-bin-2-fill pr-0"></i></button>
                           </p>
                         </div>
                       </div>

                       <div class="row">
                         <div class="form-group col-md-6">
                           <label class="control-label">Surgical History</label>
                           <textarea class="form-control" rows="2" formControlName="anySurgicalHistory" ></textarea>
                         </div>
                         
                         <div class="form-group col-md-6">
                          <label>Relevant Document</label>
                          <div class="input-group">
                             <input [class.d-none]="disableForm" type="file" id="surgicalHistoryFile" (change)="onFileChange($event, 'anySurgicalHistory')" >
                             <div class="input-group-append" *ngIf="file_anySurgicalHistory">
                               <button type="button" class="btn btn-primary" (click)="uploadFile('anySurgicalHistory')">Upload</button>
                             </div>
                           </div>
                           <p class="mt-3" *ngFor="let filename of uploadedFiles_anySurgicalHistory">
                            <a (click)="getSignedUrl('anySurgicalHistory', getOnlyFileName(filename))"  href="javascript:void(0);" class="mr-3" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                            <button type="button" 
                            *ngIf="!disableForm"
                            (click)="confirmDeleteFile('anySurgicalHistory', filename)"
                            class="btn btn-sm btn-primary custom-btn-icon mr-3" ><i class="ri-delete-bin-2-fill pr-0"></i></button>
                           </p>
                         </div>
                       </div>

                       <div class="row">
                         <div class="form-group col-md-6">
                           <label class="control-label">Present Health Complaints <span class="text-danger">*</span></label>
                           <textarea class="form-control" rows="2"
                           [class.is-invalid]="isSubmittedStep2 && step2FormData.presentHealthComplaints.errors"
                           formControlName="presentHealthComplaints" ></textarea>
                           <div class="invalid-feedback" >
                             {{ getErrorMessage('presentHealthComplaints') }}
                           </div>
                         </div>
                         
                         
                         <div class="form-group col-md-6">
                          <label>Relevant Document</label> 
                          <div class="input-group">
                             <input [class.d-none]="disableForm" type="file" id="presentHealthComplaintsFile" (change)="onFileChange($event, 'presentHealthComplaints')" >
                             <div class="input-group-append" *ngIf="file_presentHealthComplaints">
                               <button type="button" class="btn btn-primary" (click)="uploadFile('presentHealthComplaints')">Upload</button>
                             </div>
                           </div>
                           <p class="mt-3" *ngFor="let filename of uploadedFiles_presentHealthComplaints">
                            <a (click)="getSignedUrl('presentHealthComplaints', getOnlyFileName(filename))"  href="javascript:void(0);" class="mr-3" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                            <button type="button" 
                            *ngIf="!disableForm"
                            (click)="confirmDeleteFile('presentHealthComplaints', filename)"
                            class="btn btn-sm btn-primary custom-btn-icon mr-3" ><i class="ri-delete-bin-2-fill pr-0"></i></button>
                           </p>
                         </div>
                       </div>
                       
                       
                       <!-- <h3 class="mt-4 mb-4" *ngIf="questionair?.length > 0">Questionnaire:</h3> -->
                       <div formArrayName="questionsArray" *ngFor="let ele of questionair; let i = index">
                       <div class="row" [ngSwitch]="ele.controlType">
                         <div class="form-group col-md-8" *ngSwitchCase="'text'">
                           <label class="control-label ">{{ele.question}}</label>
                           <input type="text" class="form-control" [formControlName]="i"
                           (change)="setAnswers(ele.controlType, $event.target.value, ele.id)" 
                           [class.is-invalid]="isSubmittedStep2 && step2FormData['questionsArray'].controls[i].errors" />
                           <div class="invalid-feedback" >
                             Answer is required
                           </div>
                         </div>
                          
                         <div class="form-group col-md-8" *ngSwitchCase="'textarea'">
                           <label class="control-label">{{ele.question}}</label>
                           <textarea class="form-control" [formControlName]="i"
                           (change)="setAnswers(ele.controlType, $event.target.value, ele.id)"
                           [class.is-invalid]="isSubmittedStep2 && step2FormData['questionsArray'].controls[i].errors"  ></textarea>
                           <div class="invalid-feedback" >
                             Answer is required
                           </div>
                         </div>
                 
                         <div class="form-group col-md-8" *ngSwitchCase="'dropdown'">
                           <label class="control-label">{{ele.question}}</label>
                           <select class="form-control form-control-lg" 
                           (change)="setAnswers(ele.controlType, $event.target.value, ele.id)"
                             [formControlName]="i" 
                             [class.is-invalid]="isSubmittedStep2 && step2FormData['questionsArray'].controls[i].errors">
                             <option value="" disabled>Select Category</option>
                             <option *ngFor="let option of ele.options">{{option.value}}</option>
                           </select>
                           <div class="invalid-feedback" >
                             Answer is required
                           </div>
                         </div>


                         <div class="form-group col-md-8" *ngSwitchCase="'radio'">
                           <label class="control-label">{{ele.question}}</label>
                           <div class="custom-control custom-radio" 
                               *ngFor="let option of ele.options; let radioIndex=index"
                               [class.is-invalid]="isSubmittedStep2 && step2FormData['questionsArray'].controls[i].errors">
                             <input type="radio" id="{{ele.id}}_{{i}}_{{radioIndex}}"
                             
                               value="{{option.value}}" class="custom-control-input" 
                               (change)="setAnswers(ele.controlType, $event.target.value, ele.id, option.value)" 
                               [formControlName]="i">
                             <label class="custom-control-label" for="{{ele.id}}_{{i}}_{{radioIndex}}"> {{option.value}} </label>
                           </div>

                           <div class="invalid-feedback" >
                             Answer is required
                           </div>
                         </div>


                         <div class="form-group col-md-8" *ngSwitchCase="'checkbox'">
                           <label class="control-label">{{ele.question}}</label>
                           <div class="custom-control custom-checkbox"
                             [formGroupName]="i"
                             *ngFor="let option of ele.options; let chkIndex = index;">
                             <input type="checkbox" class="custom-control-input" 
                             (change)="setAnswers(ele.controlType, $event.target.checked, ele.id)"
                             id="{{ele.id}}_{{i}}_{{chkIndex}}" 
                             [formControlName]="chkIndex" value="{{option.value}}">
                             <label class="custom-control-label" for="{{ele.id}}_{{i}}_{{chkIndex}}">{{option.value}}</label>
                           </div>
                         </div>
                          
                       </div>

                       </div>


                      <button type="button" [class.d-none]="!disableForm" class="btn btn-primary next action-button float-right" (click)="changeStep(3)" >Next</button>
                      <button type="button" [class.d-none]="!disableForm" (click)="prevStep()" class="btn btn-light float-right mr-3" >Previous</button>
                      <button type="button" [class.d-none]="!disableForm || !caseEditable" (click)="editForm(true)" class="btn btn-light float-right mr-3" >Edit Form</button>
                      <button type="button" [class.d-none]="!disableForm" class="btn btn-light float-right mr-3" routerLink="/caremanager/cases" >Exit</button>

                      <button type="button" [class.d-none]="disableForm" (click)="saveForm()" class="btn btn-primary float-right mr-3" >Save</button>
                      <button type="button" [class.d-none]="disableForm" (click)="editForm(false)" class="btn btn-light float-right mr-3" >Cancel</button>
                      
                    </div>
                 </div>
              </div>
              
           </form>

            <div class="row setup-content" id="caseHistoryDetails" [style.display]="step == 3 ? 'flex' : 'none'">
               <div class="col-sm-12">
                  <div class="col-md-12 p-0">
                     <h3 class="mb-4">Case history:</h3>
                     <table class="table table-striped table-bordered">
                      <tr>
                        <th>Case Id</th>
                        <th>Service</th>
                        <th>Care Manager </th>
                        <th>Doctor </th>
                        <th>Status </th>
                      </tr>
                      <tr *ngFor="let case of caseHistoryList">
                        <td>{{case.id}}</td>
                        <td >{{case.categoryName}}</td>
                        <td >{{case.caremanagerName}}</td>
                        <td >{{case.doctorName}}</td>
                        <td >{{case.status}}</td>
                      </tr>
                    </table>
                    

                    <button type="button" class="btn btn-primary next action-button float-right" (click)="changeStep(4)" >Next</button>
                    <button type="button" (click)="prevStep()" class="btn btn-light float-right mr-3" >Previous</button>
                    <button type="button" class="btn btn-light float-right mr-3" routerLink="/caremanager/cases" >Exit</button>
                  </div>
               </div>
            </div>
            
         
            <div class="row setup-content" id="reportsSection" [style.display]="step == 4 ? 'flex' : 'none'">
              <div class="col-sm-12">
                 <div class="col-md-12 p-0">
                    <h3 class="mb-4">Download Reports:</h3>
                    <table class="table table-striped table-bordered">
                     <tr>
                       <th>Report Type</th>
                       <th>Download</th>
                       
                     </tr>
                     <tr>
                       <td>Prescribed Drugs</td>
                       <td>
                        <!-- <button type="button" class="btn btn-outline-link mb-3"><i class="ri-heart-line"></i>Link</button> -->
                          <a (click)="getSignedUrl('prescribedDrugFile', getOnlyFileName(filename))" *ngFor="let filename of uploadedFiles_prescribedDrugFile" href="javascript:void(0);" class="mr-4" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                       </td>
                     </tr>
                     <tr>
                       <td>Present Health Complaints</td>
                       <td>
                          <a (click)="getSignedUrl('presentHealthComplaints', getOnlyFileName(filename))" *ngFor="let filename of uploadedFiles_presentHealthComplaints" href="javascript:void(0);" class="mr-4" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                       </td>
                     </tr>
                     <tr>
                       <td>Surgical History</td>
                       <td>
                          <a (click)="getSignedUrl('anySurgicalHistory', getOnlyFileName(filename))" *ngFor="let filename of uploadedFiles_anySurgicalHistory" href="javascript:void(0);" class="mr-4" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                       </td>
                     </tr>
                     <tr>
                       <td>Past History of Major illness</td>
                       <td>
                          <a (click)="getSignedUrl('pastHistoryofMajorillness', getOnlyFileName(filename))" *ngFor="let filename of uploadedFiles_pastHistoryofMajorillness" href="javascript:void(0);" class="mr-4" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                       </td>
                     </tr>
                     <tr>
                       <td>Allergy Report</td>
                       <td>
                          <a (click)="getSignedUrl('allergyDocFile', getOnlyFileName(filename))" *ngFor="let filename of uploadedFiles_allergyDocFile" href="javascript:void(0);" class="mr-4" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                       </td>
                     </tr>
                     <tr>
                       <td>Upload Prescription</td>
                       <td>
                        <div class="form-group">
                          <p class="mt-3">
                            <a (click)="getSignedUrl('prescription', getOnlyFileName(filename))" *ngFor="let filename of uploadedFiles_prescriptionFile" href="javascript:void(0);" class="mr-4" ><i class="ri-download-line"></i> {{getOnlyFileName(filename)}}</a>
                          </p>
                        </div>
                       </td>
                     </tr>

                   </table>
                   

                   <button type="button" class="btn btn-primary next action-button float-right" (click)="changeStep(5)" >Next</button>
                   <button type="button" (click)="prevStep()" class="btn btn-light float-right mr-3" >Previous</button>
                   <button type="button" class="btn btn-light float-right mr-3" routerLink="/caremanager/cases" >Exit</button>

                 </div>
              </div>
           </div>
                 
           <div class="row setup-content" id="caseSummary" [style.display]="step == 5 ? 'flex' : 'none'">
            <div class="col-sm-12">
               <div class="col-md-12 p-0">
                  <h3 class="mb-4">Observations:</h3>
                  <table class="table table-striped table-bordered">
                   <tr *ngIf="!observationList || observationList == [] || observationList == ''">
                        <td>Your case details are still being reviewed by the Care Manager / Doctor.</td>
                   </tr>   
                   <tr *ngFor="let observation of observationList">
                     <td>
                       <p class="text-justify">
                          {{observation.observation}}
                       </p>
                       <span class="text-primary">{{observation.observationBy}}</span>
                     </td>
                   </tr>
                 </table>
                 

                 <button type="button" (click)="prevStep()" class="btn btn-dark float-right mr-3" >Previous</button>
                 <button type="button" class="btn btn-light float-right mr-3" routerLink="/caremanager/cases" >Exit</button>

               </div>
            </div>
         </div>
                
             </div>
          </div>
       </div>
    </div>
  </div>